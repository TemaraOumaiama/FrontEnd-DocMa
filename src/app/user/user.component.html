<ng-container>
  <div id="wrapper">
    <!-- Sidebar -->
    <ul
      class="navbar-nav bg-gradient-primary sidebar sidebar-dark accordion"
      id="accordionSidebar"
    >
      <!-- Sidebar - Brand -->
      <a
        class="sidebar-brand d-flex align-items-center justify-content-center"
        href="index.html"
      >
        <div class="sidebar-brand-icon" style="margin-top: 50px">
          <img
            src="./assets/LOGO1.png"
            height="50"
            alt="helxlo"
            loading="lazy"
            class="logo-image"
          />
        </div>
      </a>
      <div style="margin-top: 30px">
        <!-- Divider -->
        <hr class="sidebar-divider my-0" />
      </div>
      <!-- Nav Item - Dashboard -->
      <li class="nav-item">
        <a
          routerLink="/homepage"
          routerLinkActive="active"
          ariaCurrentWhenActive="page"
          class="nav-link"
        >
          <i class="fas fa-home"></i>
          <span>Acceuil</span></a
        >
      </li>

      <!-- Divider -->
      <hr class="sidebar-divider" />

      <!-- Heading -->
      <li class="nav-item">
        <a
          routerLink="/dossier"
          routerLinkActive="active"
          ariaCurrentWhenActive="page"
          class="nav-link"
        >
          <i class="fa-solid fa-folder"></i>
          <span>Gestion des dossiers</span>
        </a>

        <div>
          <a
            routerLink="/document"
            routerLinkActive="active"
            ariaCurrentWhenActive="page"
            class="nav-link"
          >
            <i class="fa-solid fa-file"></i>
            <span> Gestion des documents Juridiques</span>
          </a>

          <script>
            document
              .getElementById("importLink")
              .addEventListener("click", function (event) {
                event.preventDefault(); // Empêche le lien de rediriger vers une autre page

                // Affichez vos documents récupérés ici
                alert("Documents non lus récupérés avec succès.");
              });
          </script>
          <div>
            <a
              routerLink="/veille"
              routerLinkActive="active"
              ariaCurrentWhenActive="page"
              class="nav-link"
            >
              <span> Consulter les rapport de veille juridique</span>
            </a>
          </div>
        </div>
      </li>

      <!-- Nav Item - Pages Collapse Menu -->
      <li class="nav-item">
        <a
          routerLink="/contrat"
          routerLinkActive="active"
          ariaCurrentWhenActive="page"
          class="nav-link"
        >
          <i class="fa-solid fa-file-contract"></i>
          <span>Gestion des contrats</span>
        </a>
      </li>

      <!-- Nav Item - Utilities Collapse Menu -->
      <div [hidden]="!isAdmin">
        <li class="nav-item">
          <a
            routerLink="/categorie"
            ariaCurrentWhenActive="page"
            class="nav-link"
          >
            <i class="fa-solid fa-table-cells-large"></i>
            <span>Gestion des catégories</span>
          </a>
        </li>
      </div>

      <!-- Divider -->
      <hr class="sidebar-divider" />

      <!-- Heading -->
      <div [hidden]="!isSuperAdmin">
        <div class="sidebar-heading">Administration</div>
        <!-- Nav Item - Charts -->
        <li class="nav-item">
          <a
            routerLink="/departement"
            routerLinkActive="active"
            ariaCurrentWhenActive="page"
            class="nav-link"
          >
            <i class="fa-solid fa-layer-group"></i>
            <span>Gestion des départements</span>
          </a>
        </li>

        <!-- Nav Item - Tables -->
        <li class="nav-item active">
          <a
            routerLink="/user/management"
            ariaCurrentWhenActive="page"
            class="nav-link"
          >
            <i class="fa-sharp fa-solid fa-user-group"></i>
            <span>Gestion des utilisateurs</span>
          </a>
        </li>

        <!-- Divider -->
        <hr class="sidebar-divider d-none d-md-block" />
      </div>
      <!-- Sidebar Toggler (Sidebar) -->
      <div class="text-center d-none d-md-inline">
        <button class="rounded-circle border-0" id="sidebarToggle"></button>
      </div>

      <!-- Sidebar Message -->
    </ul>
    <!-- End of Sidebar -->

    <!-- Content Wrapper -->
    <div id="content-wrapper" class="d-flex flex-column">
      <!-- Main Content -->
      <div id="content">
        <!-- Topbar -->
        <nav
          class="navbar navbar-expand navbar-light bg-white topbar mb-4 static-top shadow"
        >
          <!-- Sidebar Toggle (Topbar) -->
          <button
            id="sidebarToggleTop"
            class="btn btn-link d-md-none rounded-circle mr-3"
          >
            <i class="fa fa-bars"></i>
          </button>

          <!-- Topbar Search -->

          <!-- Topbar Navbar -->
          <ul class="navbar-nav ml-auto">
            <!-- Nav Item - Search Dropdown (Visible Only XS) -->
            <li class="nav-item dropdown no-arrow d-sm-none">
              <a
                class="nav-link dropdown-toggle"
                href="#"
                id="searchDropdown"
                role="button"
                data-toggle="dropdown"
                aria-haspopup="true"
                aria-expanded="false"
              >
                <i class="fas fa-search fa-fw"></i>
              </a>
              <!-- Dropdown - Messages -->
              <div
                class="dropdown-menu dropdown-menu-right p-3 shadow animated--grow-in"
                aria-labelledby="searchDropdown"
              >
                <form class="form-inline mr-auto w-100 navbar-search">
                  <div class="input-group">
                    <input
                      type="text"
                      class="form-control bg-light border-0 small"
                      placeholder="Search for..."
                      aria-label="Search"
                      aria-describedby="basic-addon2"
                    />
                    <div class="input-group-append">
                      <button class="btn btn-primary" type="button">
                        <i class="fas fa-search fa-sm"></i>
                      </button>
                    </div>
                  </div>
                </form>
              </div>
            </li>

            <!-- Nav Item - Alerts -->
            <li class="nav-item dropdown no-arrow mx-1">
              <a
                class="nav-link dropdown-toggle"
                href="#"
                id="alertsDropdown"
                role="button"
                data-toggle="dropdown"
                aria-haspopup="true"
                aria-expanded="false"
              >
                <i class="fas fa-bell fa-fw"></i>
                <!-- Counter - Alerts -->
                <span class="badge badge-danger badge-counter">3+</span>
              </a>
              <!-- Dropdown - Alerts -->
              <div
                class="dropdown-list dropdown-menu dropdown-menu-right shadow animated--grow-in"
                aria-labelledby="alertsDropdown"
              >
                <h6 class="dropdown-header">Alerts Center</h6>
                <a class="dropdown-item d-flex align-items-center" href="#">
                  <div class="mr-3">
                    <div class="icon-circle bg-primary">
                      <i class="fas fa-file-alt text-white"></i>
                    </div>
                  </div>
                  <div>
                    <div class="small text-gray-500">December 12, 2019</div>
                    <span class="font-weight-bold"
                      >A new monthly report is ready to download!</span
                    >
                  </div>
                </a>
                <a class="dropdown-item d-flex align-items-center" href="#">
                  <div class="mr-3">
                    <div class="icon-circle bg-success">
                      <i class="fas fa-donate text-white"></i>
                    </div>
                  </div>
                  <div>
                    <div class="small text-gray-500">December 7, 2019</div>
                    $290.29 has been deposited into your account!
                  </div>
                </a>
                <a class="dropdown-item d-flex align-items-center" href="#">
                  <div class="mr-3">
                    <div class="icon-circle bg-warning">
                      <i class="fas fa-exclamation-triangle text-white"></i>
                    </div>
                  </div>
                  <div>
                    <div class="small text-gray-500">December 2, 2019</div>
                    Spending Alert: We've noticed unusually high spending for
                    your account.
                  </div>
                </a>
                <a
                  class="dropdown-item text-center small text-gray-500"
                  href="#"
                  >Show All Alerts</a
                >
              </div>
            </li>

            <!-- Nav Item - Messages -->
            <li class="nav-item dropdown no-arrow mx-1">
              <a
                class="nav-link dropdown-toggle"
                href="#"
                id="messagesDropdown"
                role="button"
                data-toggle="dropdown"
                aria-haspopup="true"
                aria-expanded="false"
              >
                <i class="fas fa-envelope fa-fw"></i>
                <!-- Counter - Messages -->
                <span class="badge badge-danger badge-counter">7</span>
              </a>
              <!-- Dropdown - Messages -->
              <div
                class="dropdown-list dropdown-menu dropdown-menu-right shadow animated--grow-in"
                aria-labelledby="messagesDropdown"
              >
                <h6 class="dropdown-header">Message Center</h6>
                <a class="dropdown-item d-flex align-items-center" href="#">
                  <div class="dropdown-list-image mr-3">
                    <img
                      class="rounded-circle"
                      src="assets/img/undraw_profile_1.svg"
                      alt="..."
                    />
                    <div class="status-indicator bg-success"></div>
                  </div>
                  <div class="font-weight-bold">
                    <div class="text-truncate">
                      Hi there! I am wondering if you can help me with a problem
                      I've been having.
                    </div>
                    <div class="small text-gray-500">Emily Fowler · 58m</div>
                  </div>
                </a>
                <a class="dropdown-item d-flex align-items-center" href="#">
                  <div class="dropdown-list-image mr-3">
                    <img
                      class="rounded-circle"
                      src="assets/img/undraw_profile_2.svg"
                      alt="..."
                    />
                    <div class="status-indicator"></div>
                  </div>
                  <div>
                    <div class="text-truncate">
                      I have the photos that you ordered last month, how would
                      you like them sent to you?
                    </div>
                    <div class="small text-gray-500">Jae Chun · 1d</div>
                  </div>
                </a>
                <a class="dropdown-item d-flex align-items-center" href="#">
                  <div class="dropdown-list-image mr-3">
                    <img
                      class="rounded-circle"
                      src="assets/img/undraw_profile_3.svg"
                      alt="..."
                    />
                    <div class="status-indicator bg-warning"></div>
                  </div>
                  <div>
                    <div class="text-truncate">
                      Last month's report looks great, I am very happy with the
                      progress so far, keep up the good work!
                    </div>
                    <div class="small text-gray-500">Morgan Alvarez · 2d</div>
                  </div>
                </a>
                <a class="dropdown-item d-flex align-items-center" href="#">
                  <div class="dropdown-list-image mr-3">
                    <img
                      class="rounded-circle"
                      src="https://source.unsplash.com/Mv9hjnEUHR4/60x60"
                      alt="..."
                    />
                    <div class="status-indicator bg-success"></div>
                  </div>
                  <div>
                    <div class="text-truncate">
                      Am I a good boy? The reason I ask is because someone told
                      me that people say this to all dogs, even if they aren't
                      good...
                    </div>
                    <div class="small text-gray-500">Chicken the Dog · 2w</div>
                  </div>
                </a>
                <a
                  class="dropdown-item text-center small text-gray-500"
                  href="#"
                  >Read More Messages</a
                >
              </div>
            </li>

            <div class="topbar-divider d-none d-sm-block"></div>

            <!-- Nav Item - User Information -->
            <li class="nav-item dropdown no-arrow">
              <a
                class="nav-link dropdown-toggle"
                href="#"
                id="userDropdown"
                role="button"
                data-toggle="dropdown"
                aria-haspopup="true"
                aria-expanded="false"
              >
                <span class="mr-2 d-none d-lg-inline text-gray-600 small"
                  >{{ user.nom }} {{ user.prenom }}</span
                >
                <img
                  class="img-profile rounded-circle"
                  src="{{ user.imageUrl }}"
                />
              </a>
              <!-- Dropdown - User Information -->
              <div
                class="dropdown-menu dropdown-menu-right shadow animated--grow-in"
                aria-labelledby="userDropdown"
              >
                <a
                  class="dropdown-item"
                  (click)="changeTitle('Profile')"
                  data-toggle="tab"
                  href="#profile"
                >
                  <i class="fas fa-user fa-sm fa-fw mr-2 text-gray-400"></i>
                  Profile
                </a>

                <a
                  class="dropdown-item"
                  (click)="changeTitle('Settings')"
                  data-toggle="tab"
                  href="#reset-password"
                >
                  <i class="fas fa-cogs fa-sm fa-fw mr-2 text-gray-400"></i>
                  Parametres
                </a>

                <div class="dropdown-divider"></div>
                <a
                  class="dropdown-item"
                  href="#"
                  data-toggle="modal"
                  data-target="#logoutModal"
                >
                  <i
                    class="fas fa-sign-out-alt fa-sm fa-fw mr-2 text-gray-400"
                  ></i>
                  Déconnecter
                </a>
              </div>
            </li>
          </ul>
        </nav>
        <!-- End of Topbar -->

        <!-- Begin Page Content -->
        <div class="container-fluid">
          <div class="container">
            <div class="row mb-2 mt-2 text-center"></div>

            <script>
              // Récupérer le bouton de basculement
              var toggleButton = document.querySelector(".navbar-toggler");

              // Récupérer la barre latérale
              var sidebar = document.getElementById("sidebarMenu");

              // Ajouter un gestionnaire d'événements pour le clic sur le bouton de basculement
              toggleButton.addEventListener("click", function () {
                // Vérifier si la barre latérale est actuellement affichée ou cachée
                var isSidebarHidden = sidebar.classList.contains("show");

                // Afficher ou cacher la barre latérale en fonction de son état actuel
                if (isSidebarHidden) {
                  sidebar.classList.remove("show");
                } else {
                  sidebar.classList.add("show");
                }
              });
            </script>

            <!-- nav bar
            <nav
              style="margin: 40px"
              class="navbar navbar-expand-md breadcrumb"
            >
              <div class="collapse navbar-collapse" id="navbarCollapse">
                <div class="nav nav-pills">
                  <a
                    class="nav-item nav-link active ml-1"
                    (click)="changeTitle('Users')"
                    data-toggle="tab"
                    href="#users"
                  >
                    <i class="fa fa-users"></i>
                    Users
                  </a>
                  <a
                    [hidden]="!isAdmin"
                    class="nav-item nav-link ml-3"
                    (click)="changeTitle('Settings')"
                    data-toggle="tab"
                    href="#reset-password"
                  >
                    <i class="fa fa-cogs"></i>
                    Settings
                  </a>
                  <a
                    class="nav-item nav-link move-right mr-3"
                    (click)="changeTitle('Profile')"
                    data-toggle="tab"
                    href="#profile"
                  >
                    Welcome, {{ user.prenom }}
                    <i class="fa fa-user"></i>
                  </a>

                  <a
                    class="nav-item nav-link move-right mr-3"
                    (click)="changeTitle('Password')"
                    data-toggle="tab"
                    href="#update-password"
                  >
                    Changer mot de passe
                    <i class="fa fa-user"></i>
                  </a>
                </div>
              </div>
            </nav>
 -->
            <!-- main content -->
            <div class="tab-content mt-3" id="myTabContent">
              <!-- user table -->
              <div class="tab-pane fade show active" id="users">
                <div class="mb-3 float-right">
                  <div class="btn-group mr-2">
                    <form
                      class="form-inline my-2 my-lg-0 justify-content-center"
                    >
                      <input
                        name="searchTerm"
                        #searchInput="ngModel"
                        class="form-control mr-sm-2"
                        ngModel
                        (ngModelChange)="searchUsers(searchInput.value)"
                        type="search"
                        placeholder="Filtrer utilisateurs..."
                      />
                    </form>
                    <button
                      [hidden]="!isAdmin"
                      type="button"
                      class="btn btn-info"
                      data-toggle="modal"
                      data-target="#addUserModal"
                    >
                      <i class="fa fa-plus"></i>Ajouter utilisateur
                    </button>
                  </div>
                  <div class="btn-group">
                    <button
                      type="button"
                      (click)="getUsers(true)"
                      class="btn btn-info"
                    >
                      <i *ngIf="refreshing" class="fas fa-sync fa-spin"></i
                      ><i *ngIf="!refreshing" class="fas fa-sync"></i>
                    </button>
                  </div>
                </div>
                <table class="table table-hover">
                  <thead class="table-borderless">
                    <tr class="text-center">
                      <th>Photo</th>
                      <th>User ID</th>
                      <th>Departement</th>
                      <th>Prenom</th>
                      <th>Nom</th>
                      <th>Username</th>
                      <th>Email</th>

                      <th>Status</th>
                      <th>Actions</th>
                    </tr>
                  </thead>
                  <tbody *ngFor="let appUser of users">
                    <tr class="text-center">
                      <td (click)="onSelectUser(appUser)">
                        <img
                          height="40"
                          width="40"
                          src="{{ appUser.imageUrl }}"
                          class="rounded-circle img-fluid img-thumbnail"
                          alt=""
                        />
                      </td>
                      <td (click)="onSelectUser(appUser)">
                        {{ appUser.userId }}
                      </td>
                      <td (click)="onSelectUser(appUser)">
                        {{ appUser?.departement?.nom }}
                      </td>
                      <td (click)="onSelectUser(appUser)">
                        {{ appUser.prenom }}
                      </td>
                      <td (click)="onSelectUser(appUser)">{{ appUser.nom }}</td>
                      <td (click)="onSelectUser(appUser)">
                        {{ appUser.username }}
                      </td>
                      <td (click)="onSelectUser(appUser)">
                        {{ appUser.email }}
                      </td>
                      <td (click)="onSelectUser(appUser)">
                        <span
                          [hidden]="!appUser.active"
                          class="badge badge-success"
                          >Active</span
                        >
                        <span
                          [hidden]="appUser.active"
                          class="badge badge-danger"
                          >Inactive</span
                        >
                      </td>
                      <td class="">
                        <div class="btn-group">
                          <button
                            class="btn btn-outline-info"
                            (click)="onEditUser(appUser)"
                          >
                            <i class="fas fa-edit"></i>
                          </button>
                          <button
                            [hidden]="!isAdmin"
                            *ngIf="appUser.username"
                            class="btn btn-outline-danger"
                            (click)="onDeleteUder(appUser.username)"
                          >
                            <i class="fas fa-trash"></i>
                          </button>
                        </div>
                      </td>
                    </tr>
                  </tbody>
                </table>
              </div>

              <button
                [hidden]="true"
                type="button"
                id="openUserInfo"
                data-toggle="modal"
                data-target="#viewUserModal"
              ></button>
              <button
                [hidden]="true"
                type="button"
                id="openUserEdit"
                data-toggle="modal"
                data-target="#editUserModal"
              ></button>

              <!-- reset password  -->
              <div
                [hidden]="!isAdmin"
                class="tab-pane fade"
                id="reset-password"
              >
                <form
                  #resetPasswordForm="ngForm"
                  (ngSubmit)="onResetPassword(resetPasswordForm)"
                >
                  <fieldset>
                    <legend>User Password Management</legend>
                    <div class="form-group">
                      <label for="exampleInputEmail1">Email address</label>
                      <input
                        type="email"
                        name="reset-password-email"
                        required
                        ngModel
                        class="form-control"
                        placeholder="Enter email (example@email.com)"
                      />
                      <small class="form-text text-muted"
                        >We'll never share your email with anyone else.</small
                      >
                    </div>
                    <button
                      type="submit"
                      [disabled]="resetPasswordForm.invalid"
                      class="btn btn-primary"
                    >
                      <i *ngIf="refreshing" class="fas fa-spinner fa-spin"></i
                      >&nbsp;&nbsp;
                      <span *ngIf="refreshing">Loading...</span>
                      <span *ngIf="!refreshing">Reset Password</span>
                    </button>
                  </fieldset>
                </form>
              </div>
              <!-- change password  -->

              <div class="tab-pane fade" id="update-password">
                <form
                  #updatePasswordForm="ngForm"
                  (ngSubmit)="onUpdatePassword(updatePasswordForm)"
                >
                  <fieldset>
                    <legend>User Password Management</legend>
                    <div class="form-group">
                      <input
                        type="text"
                        name="username"
                        autocomplete="username"
                        style="
                          position: absolute;
                          top: -9999px;
                          left: -9999px;
                          visibility: hidden;
                        "
                      />
                    </div>
                    <div class="form-group">
                      <label for="newPassword">New Password</label>

                      <input
                        type="password"
                        name="newPassword"
                        required
                        [(ngModel)]="newPassword"
                        placeholder="Enter new password"
                        class="form-control"
                        autocomplete="new-password"
                      />
                    </div>
                    <button
                      type="submit"
                      [disabled]="updatePasswordForm.invalid"
                      class="btn btn-primary"
                    >
                      <i *ngIf="refreshing" class="fas fa-spinner fa-spin"></i
                      >&nbsp;&nbsp;
                      <span *ngIf="refreshing">Loading...</span>
                      <span *ngIf="!refreshing">Update Password</span>
                    </button>
                  </fieldset>
                </form>
              </div>

              <!-- user profile -->
              <div class="tab-pane fade" id="profile">
                <div class="container">
                  <div class="row flex-lg-nowrap">
                    <div class="col">
                      <div class="row">
                        <div class="col mb-3">
                          <div class="card">
                            <div class="card-body">
                              <div class="e-profile">
                                <div class="row">
                                  <div class="col-12 col-sm-auto">
                                    <div class="mx-auto" style="width: 120px">
                                      <div
                                        class="d-flex justify-content-center align-items-center rounded"
                                      >
                                        <img
                                          class="rounded"
                                          height="135"
                                          width="135"
                                          src="{{ user.imageUrl }}"
                                          alt=""
                                        />
                                      </div>
                                      <div
                                        *ngIf="fileStatus.status === 'progress'"
                                        class="progress mt-1"
                                      >
                                        <div
                                          class="progress-bar bg-info"
                                          role="progressbar"
                                          [style.width.%]="
                                            fileStatus.percentage
                                          "
                                          aria-valuenow="0"
                                          aria-valuemin="0"
                                          aria-valuemax="100"
                                        >
                                          {{ fileStatus.percentage }}%
                                        </div>
                                      </div>
                                    </div>
                                  </div>
                                  <div
                                    class="col d-flex flex-column flex-sm-row justify-content-between mb-3"
                                  >
                                    <div
                                      class="text-center text-sm-left mb-2 mb-sm-0"
                                    >
                                      <h4 class="pt-sm-2 pb-1 mb-0 text-nowrap">
                                        {{ user.prenom }} {{ user.nom }}
                                      </h4>
                                      <p class="mb-0">{{ user.username }}</p>
                                      <div
                                        *ngIf="
                                          user.lastLoginDateDisplay !== null
                                        "
                                        class="text-muted"
                                      >
                                        <small
                                          >Last login:
                                          {{
                                            user.lastLoginDateDisplay
                                              | date : "medium"
                                          }}</small
                                        >
                                      </div>
                                      <div class="custom-file">
                                        <input
                                          type="file"
                                          accept="image/*"
                                          name="imageURl"
                                          (change)="onimageUrlChange($event)"
                                          class="custom-file-input"
                                        />
                                        <label class="custom-file-label"
                                          ><span [hidden]="!fileName">{{
                                            fileName
                                          }}</span>
                                          <span [hidden]="fileName"
                                            >Choose File</span
                                          >
                                        </label>
                                      </div>
                                    </div>
                                  </div>
                                  <div class="text-center text-sm-right">
                                    <div class="text-muted">
                                      <small
                                        >Joined
                                        {{
                                          user.datecreation
                                            | date : "mediumDate"
                                        }}</small
                                      >
                                    </div>
                                  </div>
                                </div>
                              </div>
                              <div class="tab-content pt-3">
                                <div class="tab-pane active">
                                  <form
                                    #profileUserForm="ngForm"
                                    (ngSubmit)="
                                      onUpdateCurrentUser(profileUserForm.value)
                                    "
                                    class="form"
                                    novalidate
                                  >
                                    <div class="row">
                                      <div class="col">
                                        <div class="row">
                                          <div class="col">
                                            <div class="form-group">
                                              <label>First Name</label>
                                              <input
                                                type="text"
                                                name="prenom"
                                                required
                                                [ngModel]="user.prenom"
                                                class="form-control"
                                                (ngModelChange)="
                                                  onPrenomChange($event)
                                                "
                                              />
                                            </div>
                                          </div>
                                          <div class="col">
                                            <div class="form-group">
                                              <label>Last Name</label>
                                              <input
                                                type="text"
                                                name="nom"
                                                required
                                                [(ngModel)]="user.nom"
                                                class="form-control"
                                                (ngModelChange)="
                                                  onNomChange($event)
                                                "
                                              />
                                            </div>
                                          </div>
                                        </div>
                                        <div class="row">
                                          <div class="col">
                                            <div class="form-group">
                                              <label>Username</label>
                                              <input
                                                type="text"
                                                name="username"
                                                required
                                                [(ngModel)]="user.username"
                                                class="form-control"
                                              />
                                            </div>
                                          </div>
                                        </div>
                                        <div class="row">
                                          <div class="col">
                                            <div class="form-group">
                                              <label>Email</label>
                                              <input
                                                type="text"
                                                name="email"
                                                required
                                                [(ngModel)]="user.email"
                                                class="form-control"
                                              />
                                            </div>
                                          </div>
                                        </div>
                                        <div class="row">
                                          <div class="col mb-3">
                                            <div class="form-group">
                                              <label>Role</label
                                              ><small [hidden]="isAdmin"
                                                >(read only)</small
                                              >
                                              <select
                                                name="role"
                                                required
                                                [(ngModel)]="user.role"
                                                class="form-control"
                                              >
                                                <option
                                                  [hidden]="!isAdmin"
                                                  value="ROLE_USER"
                                                >
                                                  USER
                                                </option>
                                                <option
                                                  [hidden]="!isAdmin"
                                                  value="ROLE_HR"
                                                >
                                                  HR
                                                </option>
                                                <option
                                                  [hidden]="!isAdmin"
                                                  value="ROLE_MANAGER"
                                                >
                                                  MANAGER
                                                </option>
                                                <option
                                                  [hidden]="!isAdmin"
                                                  value="ROLE_ADMIN"
                                                >
                                                  ADMIN
                                                </option>
                                                <option
                                                  [hidden]="!isAdmin"
                                                  value="ROLE_SUPER_ADMIN"
                                                >
                                                  SUPER ADMIN
                                                </option>
                                              </select>
                                            </div>
                                          </div>
                                        </div>
                                      </div>
                                    </div>
                                    <div class="row">
                                      <div
                                        class="col-12 col-sm-5 offset-sm-1 mb-3"
                                      >
                                        <div class="mb-2">
                                          <b>Account Settings</b>
                                        </div>
                                        <div class="row">
                                          <div class="col">
                                            <div
                                              class="custom-controls-stacked px-2"
                                            >
                                              <div
                                                class="custom-control custom-checkbox"
                                              >
                                                <input
                                                  name="active"
                                                  type="checkbox"
                                                  [(ngModel)]="user.active"
                                                  class="custom-control-input"
                                                />
                                                <label
                                                  class="custom-control-label"
                                                  >Active</label
                                                >
                                              </div>
                                              <div
                                                class="custom-control custom-checkbox"
                                              >
                                                <input
                                                  name="notLocked"
                                                  type="checkbox"
                                                  [(ngModel)]="user.notLocked"
                                                  class="custom-control-input"
                                                />
                                                <label
                                                  class="custom-control-label"
                                                  >Unlocked</label
                                                >
                                              </div>
                                            </div>
                                          </div>
                                        </div>
                                      </div>
                                    </div>
                                    <div class="row">
                                      <div
                                        class="col d-flex justify-content-end"
                                      >
                                        <button
                                          class="btn btn-primary"
                                          type="submit"
                                        >
                                          <i
                                            *ngIf="refreshing"
                                            class="fas fa-spinner fa-spin"
                                          ></i
                                          >&nbsp;&nbsp;
                                          <span *ngIf="refreshing"
                                            >Loading...</span
                                          >
                                          <span *ngIf="!refreshing"
                                            >Save Changes</span
                                          >
                                        </button>
                                      </div>
                                    </div>
                                  </form>
                                </div>
                              </div>
                            </div>
                          </div>
                        </div>
                      </div>
                      <div class="col-12 col-md-3 mb-3">
                        <div class="card mb-3">
                          <div class="card-body">
                            <div class="px-xl-3">
                              <button
                                (click)="onLogOut()"
                                class="btn btn-block btn-secondary"
                              >
                                <span>Logout</span>
                                <i class="fas fa-sign-in-alt ml-1"></i>
                              </button>
                            </div>
                          </div>
                        </div>
                        <div class="card">
                          <div class="card-body">
                            <h6 class="card-title font-weight-bold">
                              Permissions From Role
                            </h6>
                            <h6
                              *ngFor="let authority of user.authorities"
                              class="card-text"
                            >
                              {{ authority }}
                            </h6>
                          </div>
                        </div>
                      </div>
                    </div>
                  </div>
                </div>
              </div>
            </div>

            <!-- modal user info -->
            <div
              class="modal fade bd-example-modal-lg"
              id="viewUserModal"
              tabindex="-1"
              role="dialog"
              aria-labelledby=""
              aria-hidden="true"
            >
              <div class="modal-dialog" role="document">
                <div class="modal-content">
                  <div class="modal-header">
                    <h5
                      class="modal-title text-center"
                      id="exampleModalLongTitle"
                    >
                      {{ selectedUser.prenom }}
                      {{ selectedUser.nom }}
                    </h5>
                    <button
                      type="button"
                      class="close"
                      data-dismiss="modal"
                      aria-label="Close"
                    >
                      <span aria-hidden="true">&times;</span>
                    </button>
                  </div>
                  <div class="modal-body">
                    <div>
                      <div class="card">
                        <div class="card-body">
                          <div class="row">
                            <div class="col-12 col-sm-auto">
                              <div class="mx-auto" style="width: 120px">
                                <div
                                  class="d-flex justify-content-center align-items-center rounded"
                                >
                                  <img
                                    class="rounded"
                                    height="120"
                                    width="120"
                                    src="{{ selectedUser.imageUrl }}"
                                    alt="{{ selectedUser.prenom }}"
                                  />
                                </div>
                              </div>
                            </div>
                            <div
                              class="col d-flex flex-column flex-sm-row justify-content-between"
                            >
                              <div class="text-center text-sm-left mb-sm-0">
                                <h6 class="pt-sm-2 pb-1 mb-0 text-nowrap">
                                  {{ selectedUser.prenom }}
                                  {{ selectedUser.nom }}
                                </h6>
                                <p class="mb-1">
                                  {{ selectedUser.username }}
                                </p>
                                <div class="">
                                  Status:
                                  <span
                                    [hidden]="!selectedUser.active"
                                    class="badge badge-success"
                                    >Active</span
                                  >
                                  <span
                                    [hidden]="selectedUser.active"
                                    class="badge badge-danger"
                                    >Inactive</span
                                  >
                                </div>
                                <div
                                  *ngIf="selectedUser.lastLoginDateDisplay"
                                  class="text-muted"
                                >
                                  <small
                                    >Last Login:
                                    {{
                                      selectedUser.lastLoginDateDisplay
                                        | date : "medium"
                                    }}</small
                                  >
                                </div>
                              </div>
                              <div class="text-center text-sm-right">
                                <div class="text-muted">
                                  <small
                                    >Joined
                                    {{
                                      selectedUser.datecreation
                                        | date : "mediumDate"
                                    }}</small
                                  >
                                </div>
                              </div>
                            </div>
                          </div>
                        </div>
                        <ul class="list-group list-group-flush">
                          <li class="list-group-item"></li>
                          <li class="list-group-item">
                            <i class="fa fa-id-badge float-right"></i
                            >{{ selectedUser.userId }}
                          </li>
                          <li class="list-group-item">
                            <i class="fa fa-envelope float-right"></i
                            >{{ selectedUser.email }}
                          </li>
                          <li class="list-group-item">
                            <i class="fas fa-shield-alt float-right"></i
                            >{{ selectedUser.role.substring(5) }}
                          </li>
                          <li
                            *ngIf="selectedUser.lastLoginDateDisplay"
                            class="list-group-item"
                          >
                            <i class="fas fa-sign-in-alt float-right"></i
                            >{{
                              selectedUser.lastLoginDateDisplay
                                | date : "medium"
                            }}
                          </li>
                          <li class="list-group-item">
                            <span [hidden]="selectedUser.notLocked">
                              <i
                                class="fa fa-lock float-right"
                                style="color: red"
                              >
                              </i>
                              Account Locked
                            </span>
                            <span [hidden]="!selectedUser.notLocked">
                              <i
                                class="fa fa-unlock float-right"
                                style="color: green"
                              >
                              </i>
                              Account Unlocked
                            </span>
                          </li>
                        </ul>
                      </div>
                    </div>
                  </div>
                  <div class="modal-footer">
                    <button
                      type="button"
                      class="btn btn-secondary"
                      data-dismiss="modal"
                    >
                      Close
                    </button>
                  </div>
                </div>
              </div>
            </div>

            <!-- model add user -->
            <div
              [hidden]="!isAdmin"
              class="modal draggable fade bd-example-modal-lg"
              id="addUserModal"
              tabindex="-1"
              role="dialog"
              aria-labelledby="exampleModalCenterTitle"
              aria-hidden="true"
            >
              <div class="modal-dialog" role="document">
                <div class="modal-content">
                  <div class="modal-header">
                    <h5 class="modal-title text-center">Ajouter utilisateur</h5>
                    <button
                      type="button"
                      class="close"
                      data-dismiss="modal"
                      aria-label="Close"
                    >
                      <span aria-hidden="true">&times;</span>
                    </button>
                  </div>
                  <div class="modal-body">
                    <div>
                      <form
                        #newUserForm="ngForm"
                        (ngSubmit)="onAddNewUser(newUserForm, departmentSelect)"
                      >
                        <div class="form-group">
                          <label for="prenom">Prenom</label>
                          <input
                            type="text"
                            name="prenom"
                            id="prenom"
                            required
                            ngModel
                            class="form-control"
                          />
                        </div>
                        <div class="form-group">
                          <label for="nom">Nom</label>
                          <input
                            type="text"
                            name="nom"
                            required
                            ngModel
                            class="form-control"
                          />
                        </div>
                        <div class="form-group">
                          <label for="username">Username</label>
                          <input
                            type="text"
                            name="username"
                            required
                            ngModel
                            class="form-control"
                          />
                        </div>

                        <div class="form-group">
                          <label for="departmentId">Département</label>
                          <select name="departmentId" #departmentSelect>
                            <option
                              *ngFor="let departement of departements"
                              [value]="departement.nom"
                            >
                              {{ departement.nom }}
                            </option>
                          </select>
                        </div>

                        <div class="form-group">
                          <label for="email">Email</label>
                          <input
                            type="email"
                            name="email"
                            required
                            ngModel
                            class="form-control"
                          />
                        </div>
                        <div *ngIf="isAdmin" class="form-group">
                          <label for="authority">Role</label>
                          <select
                            name="role"
                            required
                            ngModel="ROLE_USER"
                            class="form-control"
                          >
                            <option value="ROLE_USER">USER</option>
                            <option value="ROLE_HR">HR</option>
                            <option value="ROLE_MANAGER">MANAGER</option>
                            <option value="ROLE_ADMIN">ADMIN</option>
                            <option value="ROLE_SUPER_ADMIN">
                              SUPER ADMIN
                            </option>
                          </select>
                        </div>
                        <div *ngIf="!isAdmin" class="form-group">
                          <label for="authority">Role</label>
                          <input
                            type="text"
                            name="role"
                            required
                            ngModel="USER"
                            readonly
                            class="form-control"
                          />
                        </div>
                        <div class="input-group mb-2">
                          <div class="custom-file">
                            <label for="imageUrl">Image</label>
                            <input
                              type="file"
                              name="imageUrl"
                              (change)="onimageUrlChange($event)"
                              #fileInput
                            />
                          </div>
                        </div>
                        <fieldset class="form-group">
                          <div class="form-check">
                            <label class="form-check-label">
                              <input
                                type="checkbox"
                                name="active"
                                ngModel
                                class="form-check-input"
                              />
                              Acitve
                            </label>
                          </div>
                          <div class="form-check disabled">
                            <label class="form-check-label">
                              <input
                                type="checkbox"
                                name="notLocked"
                                ngModel
                                class="form-check-input"
                              />
                              Unlocked
                            </label>
                          </div>
                        </fieldset>
                        <button
                          type="submit"
                          style="display: none"
                          id="new-user-save"
                        ></button>
                      </form>
                    </div>
                  </div>
                  <div class="modal-footer">
                    <button
                      type="button"
                      class="btn btn-secondary"
                      data-dismiss="modal"
                      id="new-user-close"
                    >
                      Close
                    </button>
                    <button
                      type="button"
                      (click)="saveNewUser()"
                      [disabled]="newUserForm.invalid"
                      class="btn btn-primary"
                    >
                      Save changes
                    </button>
                  </div>
                </div>
              </div>
            </div>

            <!-- modal edit user -->
            <div
              class="modal draggable fade bd-example-modal-lg"
              id="editUserModal"
              tabindex="-1"
              role="dialog"
              aria-labelledby="exampleModalCenterTitle"
              aria-hidden="true"
            >
              <div class="modal-dialog" role="document">
                <div class="modal-content">
                  <div class="modal-header">
                    <h5 class="modal-title text-center">
                      Edit {{ editUser.prenom }} {{ editUser.nom }}
                      <small [hidden]="isAdminOrManager"> (read only) </small>
                    </h5>
                    <button
                      type="button"
                      class="close"
                      data-dismiss="modal"
                      aria-label="Close"
                    >
                      <span aria-hidden="true">&times;</span>
                    </button>
                  </div>
                  <div class="modal-body">
                    <div class="">
                      <form #editUserForm="ngForm">
                        <div class="form-group">
                          <label for="prenom">First Name</label>
                          <input
                            type="text"
                            name="prenom"
                            [disabled]="!isAdminOrManager"
                            required
                            [(ngModel)]="editUser.prenom"
                            class="form-control"
                          />
                        </div>
                        <div class="form-group">
                          <label for="nom">Last Name</label>
                          <input
                            type="text"
                            name="nom"
                            [disabled]="!isAdminOrManager"
                            required
                            [(ngModel)]="editUser.nom"
                            class="form-control"
                          />
                        </div>
                        <div class="form-group">
                          <label for="username">Username</label>
                          <input
                            type="text"
                            name="username"
                            [disabled]="!isAdminOrManager"
                            required
                            [(ngModel)]="editUser.username"
                            class="form-control"
                          />
                        </div>
                        <div class="form-group">
                          <label for="email">Email</label>
                          <input
                            type="email"
                            name="email"
                            [disabled]="!isAdminOrManager"
                            required
                            [(ngModel)]="editUser.email"
                            class="form-control"
                          />
                        </div>
                        <div class="form-group">
                          <label for="authority"
                            >Role
                            <small [hidden]="isAdmin">(read only)</small></label
                          >
                          <select
                            name="role"
                            [disabled]="!isAdmin"
                            required
                            [(ngModel)]="editUser.role"
                            class="form-control"
                          >
                            <option value="ROLE_USER">USER</option>
                            <option value="ROLE_HR">HR</option>
                            <option value="ROLE_MANAGER">MANAGER</option>
                            <option value="ROLE_ADMIN">ADMIN</option>
                            <option value="ROLE_SUPER_ADMIN">
                              SUPER ADMIN
                            </option>
                          </select>
                        </div>
                        <div class="input-group mb-2">
                          <div class="custom-file">
                            <label for="imageUrl">Image</label>
                            <input
                              type="file"
                              name="imageUrl"
                              (change)="onimageUrlChange($event)"
                              #fileInput
                            />
                          </div>
                        </div>
                        <fieldset class="form-group">
                          <div class="form-check">
                            <label class="form-check-label">
                              <input
                                name="active"
                                type="checkbox"
                                [disabled]="!isManager"
                                [(ngModel)]="editUser.active"
                                class="form-check-input"
                              />
                              Active
                              <small [hidden]="isManager">(read only)</small>
                            </label>
                          </div>
                          <div class="form-check disabled">
                            <label class="form-check-label">
                              <input
                                name="locked"
                                type="checkbox"
                                [disabled]="!isManager"
                                [(ngModel)]="editUser.notLocked"
                                class="form-check-input"
                              />
                              Unlocked
                              <small [hidden]="isManager">(read only)</small>
                            </label>
                          </div>
                        </fieldset>
                      </form>
                    </div>
                  </div>
                  <div class="modal-footer">
                    <button
                      type="button"
                      class="btn btn-secondary"
                      data-dismiss="modal"
                      id="closeEditUserModalButton"
                    >
                      Close
                    </button>
                    <button
                      type="button"
                      (click)="onUpdateUser()"
                      [disabled]="editUserForm.invalid || !isAdminOrManager"
                      class="btn btn-primary"
                    >
                      Save changes
                    </button>
                  </div>
                </div>
              </div>
            </div>

            <!-- modal edit user -->
            <div
              class="modal draggable fade bd-example-modal-lg"
              id="editUserModal"
              tabindex="-1"
              role="dialog"
              aria-labelledby="exampleModalCenterTitle"
              aria-hidden="true"
            >
              <div class="modal-dialog" role="document">
                <div class="modal-content">
                  <div class="modal-header">
                    <h5 class="modal-title text-center">
                      Edit {{ editUser.prenom }} {{ editUser.nom }}
                    </h5>
                    <button
                      type="button"
                      class="close"
                      data-dismiss="modal"
                      aria-label="Close"
                    >
                      <span aria-hidden="true">&times;</span>
                    </button>
                  </div>
                  <div class="modal-body">
                    <div class="">
                      <form #editUserForm="ngForm">
                        <div class="form-group">
                          <label for="prenom">First Name</label>
                          <input
                            type="text"
                            name="prenom"
                            required
                            [(ngModel)]="editUser.prenom"
                            class="form-control"
                          />
                        </div>
                        <div class="form-group">
                          <label for="nom">Last Name</label>
                          <input
                            type="text"
                            name="nom"
                            required
                            [(ngModel)]="editUser.nom"
                            class="form-control"
                          />
                        </div>
                        <div class="form-group">
                          <label for="username">Username</label>
                          <input
                            type="text"
                            name="username"
                            required
                            [(ngModel)]="editUser.username"
                            class="form-control"
                          />
                        </div>
                        <div class="form-group">
                          <label for="email">Email</label>
                          <input
                            type="email"
                            name="email"
                            required
                            [(ngModel)]="editUser.email"
                            class="form-control"
                          />
                        </div>
                        <div class="form-group">
                          <label for="authority">Role</label>
                          <select
                            name="role"
                            required
                            [(ngModel)]="editUser.role"
                            class="form-control"
                          >
                            <option value="ROLE_USER">USER</option>
                            <option value="ROLE_HR">HR</option>
                            <option value="ROLE_MANAGER">MANAGER</option>
                            <option value="ROLE_ADMIN">ADMIN</option>
                            <option value="ROLE_SUPER_ADMIN">
                              SUPER ADMIN
                            </option>
                          </select>
                        </div>
                        <div class="input-group mb-2">
                          <div class="input-group-prepend">
                            <span class="input-group-text"
                              >Profile Picture
                            </span>
                          </div>
                          <div class="custom-file">
                            <input
                              type="file"
                              accept="image/*"
                              name="imageUrl"
                              (change)="onimageUrlChange($event)"
                              #fileInput
                            />

                            <label class="custom-file-label"
                              ><span [hidden]="!fileName">{{ fileName }}</span>
                              <span [hidden]="fileName">Choose File</span>
                            </label>
                          </div>
                        </div>
                        <fieldset class="form-group">
                          <div class="form-check">
                            <label class="form-check-label">
                              <input
                                name="active"
                                type="checkbox"
                                [(ngModel)]="editUser.active"
                                class="form-check-input"
                              />
                              Acitve
                            </label>
                          </div>
                          <div class="form-check disabled">
                            <label class="form-check-label">
                              <input
                                name="locked"
                                type="checkbox"
                                [(ngModel)]="editUser.notLocked"
                                class="form-check-input"
                              />
                              Unlocked
                            </label>
                          </div>
                        </fieldset>
                      </form>
                    </div>
                  </div>
                  <div class="modal-footer">
                    <button
                      type="button"
                      class="btn btn-secondary"
                      data-dismiss="modal"
                      id="closeEditUserModalButton"
                    >
                      Close
                    </button>
                    <button
                      type="button"
                      (click)="onUpdateUser()"
                      [disabled]="editUserForm.invalid"
                      class="btn btn-primary"
                    >
                      Save changes
                    </button>
                  </div>
                </div>
              </div>
            </div>

            <!-- profile image change form -->
            <form enctype="multipart/form-data" style="display: none">
              <input
                type="file"
                (change)="onimageUrlChange($event); updateimageUrl()"
                name="profile-image-input"
                id="profile-image-input"
                placeholder="file"
                accept="image/*"
              />
            </form>
          </div>
        </div>

        <!-- End of Page Wrapper -->

        <!-- Scroll to Top Button-->
        <a class="scroll-to-top rounded" href="#page-top">
          <i class="fas fa-angle-up"></i>
        </a>

        <!-- Logout Modal-->
        <div
          class="modal fade"
          id="logoutModal"
          tabindex="-1"
          role="dialog"
          aria-labelledby="exampleModalLabel"
          aria-hidden="true"
        >
          <div class="modal-dialog" role="document">
            <div class="modal-content">
              <div class="modal-header">
                <h5 class="modal-title" id="exampleModalLabel">
                  Prêt à partir ?
                </h5>
                <button
                  class="close"
                  type="button"
                  data-dismiss="modal"
                  aria-label="Close"
                >
                  <span aria-hidden="true">×</span>
                </button>
              </div>
              <div class="modal-body">
                Sélectionnez "Déconnexion" ci-dessous si vous souhaitez mettre
                fin à votre session en cours.
              </div>
              <div class="modal-footer">
                <button
                  class="btn btn-secondary"
                  type="button"
                  data-dismiss="modal"
                >
                  Annuler
                </button>
                <a class="btn btn-primary" (click)="onLogOut()">Déconnecter</a>
              </div>
            </div>
          </div>
        </div>

        <!-- Bootstrap core JavaScript-->
      </div>
    </div>
  </div>

  <script src="./assets/vendor/bootstrap/js/bootstrap.bundle.min.js"></script>

  <script src="./assets/script.js"></script>
  <script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>

  <!-- Inclure Popper.js depuis un CDN (facultatif, requis pour certains composants Bootstrap) -->
  <script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/2.10.2/umd/popper.min.js"></script>

  <!-- Inclure Bootstrap depuis un CDN -->
  <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
</ng-container>
